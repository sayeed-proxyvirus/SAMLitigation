using Microsoft.Data.SqlClient;
using Microsoft.EntityFrameworkCore;
using SAMLitigation.Models;
using SAMLitigation.Models.ApplicationDbContext;

namespace SAMLitigation.Services.ServiceImple
{
    public class LitigationDetailDocumentListServiceImple : LitigationDetailDocumentListService
    {
        private readonly SAMDbContext _context;

        public LitigationDetailDocumentListServiceImple(SAMDbContext context)
        {
            _context = context;
        }

        public List<SAM_Litigation_Detail_DocumentList> GetAllDocumentsByLitigationDetailId(decimal litigationDetailId)
        {
            try
            {
                var param = new SqlParameter("@Id", litigationDetailId);
                var documents = _context.Litigation_Details_DocumentList
                    .FromSqlRaw("EXEC GetDetailDocumentListById @Id", param)
                    .ToList();
                return documents;
            }
            catch (Exception)
            {
                throw;
            }
        }

        public SAM_Litigation_Detail_DocumentList GetDetailDocumentListByIdForUpdate(decimal documentListId)
        {
            try
            {
                var document = _context.Litigation_Details_DocumentList
                    .FirstOrDefault(l => l.DocumentListID == documentListId);
                return document;
            }
            catch (Exception)
            {
                throw;
            }
        }

        public bool Add(SAM_Litigation_Detail_DocumentList sAM_Litigation_Detail_DocumentList)
        {
            try
            {
                _context.Litigation_Details_DocumentList.Add(sAM_Litigation_Detail_DocumentList);
                int result = _context.SaveChanges();
                return result > 0;
            }
            catch (Exception)
            {
                throw;
            }
        }

        public bool Update(SAM_Litigation_Detail_DocumentList sAM_Litigation_Detail_DocumentList)
        {
            try
            {
                _context.Litigation_Details_DocumentList.Update(sAM_Litigation_Detail_DocumentList);
                int result = _context.SaveChanges();
                return result > 0;
            }
            catch (Exception)
            {
                throw;
            }
        }
    }
}