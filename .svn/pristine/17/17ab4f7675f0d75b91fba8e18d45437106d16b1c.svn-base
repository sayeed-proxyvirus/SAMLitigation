@* Views/Shared/_MenuTreePartial.cshtml *@
@model List<SAMLitigation.Models.ViewModel.MenuItemViewModel>

@if (Model != null && Model.Any())
{
    @foreach (var menu in Model)
    {
        <li>
            @if (menu.IsMenu && menu.ChildrenMenu != null && menu.ChildrenMenu.Any())
            {
                @* This is a folder with children *@
                <a class="nav-link d-flex justify-content-between align-items-center"
                   data-bs-toggle="collapse"
                   href="#menu_@menu.MenuID"
                   role="button"
                   aria-expanded="false"
                   aria-controls="menu_@menu.MenuID">
                    <span>
                        <i class="@menu.Icon me-2"></i> @menu.MenuName
                    </span>
                    <i class="bi bi-caret-down-fill"></i>
                </a>

                <ul class="collapse nav flex-column ms-3" id="menu_@menu.MenuID">
                    @* Recursive call for children *@
                    @await Html.PartialAsync("_MenuTreePartial", menu.ChildrenMenu)
                </ul>
            }
            else if (menu.IsMenu)
            {
                @* This is a folder without children *@
                <a class="nav-link" href="javascript:void(0);">
                    <i class="@menu.Icon me-2"></i> @menu.MenuName
                </a>
            }
            else
            {
                @* This is an action/page link *@
                <a class="nav-link"
                   asp-controller="@menu.ControllerName"
                   asp-action="@menu.ActionName">
                    <i class="@menu.Icon me-2"></i> @menu.MenuName
                </a>
            }
        </li>
    }
}
else
{
    <li>
        <span class="nav-link text-muted">
            <i class="bi bi-exclamation-circle me-2"></i> No menu items available
        </span>
    </li>
}